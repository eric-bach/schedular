type Data @model @aws_cognito_user_pools {
  pk: String
  sk: String
  type: String
  category: String
  appointmentDateEpoch: Float
  duration: Int
  status: String
  appointmentId: String
  appointmentDetails: AppointmentDetailsData
  customerId: String
  customerDetails: CustomerDetailsData
  firstName: String
  lastName: String
  email: String
  phoneNumber: String
  createdAt: AWSDateTime
  updatedAt: AWSDateTime
}

type AppointmentDetailsData @model @aws_cognito_user_pools {
  date: AWSDateTime
  time: String
  duration: Int
}

type CustomerDetailsData @model @aws_cognito_user_pools {
  email: String
  phone: String
}

input CustomerInput {
  id: String
  name: String
  email: String
  phone: String
}

input BookingInput {
  pk: String!
  sk: String!
  customer: CustomerInput!
}

input LastEvaluatedKey {
  pk: ID
  sk: String
}

type LastEvaluatedKeyViewModel {
  pk: ID
  sk: String
}

type AvailableAppointmentViewModel {
  pk: String
  sk: String
  type: String
  category: String
  appointmentDateEpoch: Float
  duration: Int
  status: String
  bookingId: String
  createdAt: AWSDateTime
  updatedAt: AWSDateTime
}

type GetAvailableAppointmentsResponse {
  items: [AvailableAppointmentViewModel]
  lastEvaluatedKey: LastEvaluatedKeyViewModel
}

type AppointmentDetailsViewModel {
  date: AWSDateTime
  time: String
  duration: Int
  type: String
  category: String
}

type CustomerDetailsViewModel {
  name: String
  email: String
  phone: String
}

type AppointmentViewModel {
  pk: String
  sk: String
  type: String
  category: String
  appointmentDateEpoch: Float
  duration: Int
  status: String
  customerId: String
  customerDetails: CustomerDetailsViewModel
  bookingId: String
  createdAt: AWSDateTime
  updatedAt: AWSDateTime
}

type GetAppointmentsResponse {
  items: [AppointmentViewModel]
  lastEvaluatedKey: LastEvaluatedKeyViewModel
}

type CustomerAppointmentViewModel {
  pk: String
  sk: String
  appointmentDateEpoch: Float
  appointmentDetails: AppointmentDetailsViewModel
  customerId: String
  customerDetails: CustomerDetailsViewModel
  status: String
  createdAt: AWSDateTime
  updatedAt: AWSDateTime
}

type GetCustomerAppointmentsResponse {
  items: [CustomerAppointmentViewModel]
  lastEvaluatedKey: LastEvaluatedKeyViewModel
}

type BookAppointmentResponse {
  pk: ID
  sk: String
  customerId: String
  customerDetails: CustomerDetailsViewModel
  appointmentId: String
  appointmentDetails: AppointmentDetailsViewModel
  createdAt: AWSDateTime
  updatedAt: AWSDateTime
}

# GraphQL actions
type Query {
  getAvailableAppointments(date: String!, lastEvaluatedKey: LastEvaluatedKey): GetAvailableAppointmentsResponse
    @aws_auth(cognito_groups: ["Users", "Admins"])
  getAppointments(date: String!, lastEvaluatedKey: LastEvaluatedKey): GetAppointmentsResponse @aws_auth(cognito_groups: ["Admins"])

  getCustomerAppointments(
    customerId: String!
    appointmentDateEpoch: Float!
    lastEvaluatedKey: LastEvaluatedKey
  ): GetCustomerAppointmentsResponse @aws_auth(cognito_groups: ["Users", "Admins"])
}

type Mutation {
  bookAppointment(bookingInput: BookingInput): BookAppointmentResponse @aws_auth(cognito_groups: ["Users", "Admins"])
}

schema {
  query: Query
  mutation: Mutation
}
